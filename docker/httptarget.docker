FROM docker.io/library/rust:1.74.1 as build-env
WORKDIR /build
COPY ./rust /build
RUN cargo build --release --bin httptarget

FROM docker.io/library/rust:1.74.1-slim
#RUN apt-get update && apt-get install -y extra-runtime-dependencies && rm -rf /var/lib/apt/lists/*
COPY --from=build-env /build/target/release/httptarget /
EXPOSE 8080
CMD ["/httptarget", "-p", "8080"]
